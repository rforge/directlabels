<!DOCTYPE html
	PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

  <head>
	<meta http-equiv="Content-Type" content="text/html;
	charset=UTF-8" />
	<link href="http://directlabels.r-forge.r-project.org/estilo1.css"
	rel="stylesheet" type="text/css" />
	<title>directlabels documentation - polygon.method</title>
  </head>

<body>

<h1><a href="../../index.html">directlabels</a> - utility.function -
Positioning Method - polygon.method</h1>

<p>Make a Positioning Method that places non-overlapping speech
polygons at the first or last points.</p>

<pre>
polygon.method &lt;- function
### Make a Positioning Method that places non-overlapping speech
### polygons at the first or last points.
(top.bottom.left.right,
### Character string indicating what side of the plot to label.
  offset.cm=0.1,
### Offset from the polygon to the most extreme data point.
  padding.cm=0.05
### Padding <a href="../../utility.function/posfuns/inside.html">inside</a> the polygon.
){
  opposite.side &lt;- c(
    left="right",
    right="left",
    top="bottom",
    bottom="top")[[top.bottom.left.right]]
  direction &lt;- if(
    top.bottom.left.right %in% c("bottom", "left")
  ) -1 else 1
  min.or.max &lt;- if(
    top.bottom.left.right %in% c("top", "right")
  ) max else min
  if(top.bottom.left.right %in% c("left", "right")){
    min.or.max.xy &lt;- "x"
    qp.target &lt;- "y"
    qp.max &lt;- "top"
    qp.min &lt;- "bottom"
    padding.h.factor &lt;- 2
    padding.w.factor &lt;- 1
    limits.fun &lt;- <a href="../../utility.function/posfuns/ylimits.html">ylimits</a>
    reduce.method &lt;- "<a href="../../utility.function/posfuns/reduce.cex.lr.html">reduce.cex.lr</a>"
  }else{
    min.or.max.xy &lt;- "y"
    qp.target &lt;- "x"
    qp.max &lt;- "right"
    qp.min &lt;- "left"
    padding.h.factor &lt;- 1
    padding.w.factor &lt;- 2
    limits.fun &lt;- <a href="../../utility.function/posfuns/xlimits.html">xlimits</a>
    reduce.method &lt;- "<a href="../../utility.function/posfuns/reduce.cex.tb.html">reduce.cex.tb</a>"
  }
  list(
    paste0(top.bottom.left.right, ".points"),
    function(d,...){
      ## set the end of the speech polygon to the original data point.
      for(xy in c("x", "y")){
        extra.coord &lt;- sprintf(# e.g. left.x
          "%s.%s", opposite.side, xy)
        d[[extra.coord]] &lt;- d[[xy]]
      }
      ## set the speech polygon position to the min or max of all
      ## label positions. e.g. max
      d[[min.or.max.xy]] &lt;- min.or.max(d[[min.or.max.xy]]) + offset.cm*direction
      d
    },
    "<a href="../../utility.function/posfuns/calc.boxes.html">calc.boxes</a>",
    reduce.method,
    function(d, ...){
      d$h &lt;- d$h + padding.cm * padding.h.factor
      d$w &lt;- d$w + padding.cm * padding.w.factor
      d
    },
    "<a href="../../utility.function/posfuns/calc.borders.html">calc.borders</a>",
    <a href="../../utility.function/posfuns/qp.labels.html">qp.labels</a>(
      qp.target,
      qp.min,
      qp.max,
      <a href="../../utility.function/posfuns/make.tiebreaker.html">make.tiebreaker</a>(min.or.max.xy, qp.target),
      limits.fun),
    "<a href="../../utility.function/posfuns/calc.borders.html">calc.borders</a>",
    "<a href="../../utility.function/posfuns/draw.polygons.html">draw.polygons</a>")
}
</pre>



<center>
<table>
<tr><td>Please
contact <a href="http://sugiyama-www.cs.titech.ac.jp/~toby/">Toby
Dylan Hocking</a> if you are
using <a href="http://directlabels.r-forge.r-project.org/">directlabels</a>
or have ideas to contribute, thanks!</td>
</tr>
<tr><td align="center">Documentation website generated from source
code version 2020.6.17
(svn revision )
using <a href="http://inlinedocs.r-forge.r-project.org">inlinedocs</a>.</td>
</tr>
<tr>
<td align="center">
    <a href="http://validator.w3.org/check?uri=referer">validate</a>
</td>
</tr>
</table>

</center>

</body>

</html>
